(this.webpackJsonpcreap=this.webpackJsonpcreap||[]).push([[0],{104:function(e,t,n){},112:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(9),r=n.n(i);n(104),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var s=n(88),c=n(62),l=n(21),u=n(22),d=n(8),h=n(28),m=n(26),p=n(13),f=n(14),v=n(159),b=n(151),g=n(152),k=n(153),C=n(154),y=n(148),x=n(160),O=n(147),w=n(86),E=n.n(w),S=n(156),_=n(59),j=n(82),R=n.n(j),A=n(71),F=n.n(A),N=n(161),T=n(158),I=n(81),D=n.n(I),L=n(80),M=n.n(L),B=n(4),U=n(72),P=n.n(U),z=n(87),W=n(141);function q(e){var t=o.a.useState(0),n=Object(z.a)(t,2),a=n[0],i=n[1];return o.a.useEffect((function(){var e=setInterval((function(){i((function(e){return e>=100?100:e+1/6.5}))}),20);return function(){clearInterval(e)}}),[a]),o.a.createElement(W.a,{variant:"determinate",style:{color:"#1976d2"},value:a,size:35})}function H(e){return o.a.createElement(T.a,{title:"Unmute all",arrow:!0},o.a.createElement(O.a,{onClick:e.onClick,size:"small"},o.a.createElement(q,null)))}function $(){var e=Object(p.a)(["\n  height: 20px;\n  width: 20px;\n  background-color: ",";\n  border-radius: 50%;\n  display: inline-block;\n  margin-left: 3px;\n"]);return $=function(){return e},e}var J=f.a.span($(),(function(e){return e.alarm?"red":"#bbb"})),V=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={alarmHeard:!1},a.stopped=!1,a.alarmTimer=null,a.componentDidMount=a.componentDidMount.bind(Object(d.a)(a)),a.checkForAlarm=a.checkForAlarm.bind(Object(d.a)(a)),a.analyze=a.analyze.bind(Object(d.a)(a)),a.stop=a.stop.bind(Object(d.a)(a)),a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.checkForAlarm()}},{key:"checkForAlarm",value:function(){if(!this.stopped){window.requestAnimationFrame(this.checkForAlarm);var e=Math.min(this.props.canvasHeight+5+4,this.props.analyser.frequencyBinCount),t=new Uint8Array(e);this.props.analyser.getByteFrequencyData(t),this.analyze(t)}}},{key:"analyze",value:function(e){var t=this;if(e.length>23){for(var n=!1,a=20;a<24;a++)n=e[a]>=200||n;n&&(clearTimeout(this.alarmTimer),this.setState({alarmHeard:!0}),this.alarmTimer=setTimeout((function(){console.log("timeout"),t.setState({alarmHeard:!1})}),500))}}},{key:"stop",value:function(){this.stopped=!0,clearTimeout(this.alarmTimer)}},{key:"render",value:function(){return o.a.createElement(J,{alarm:this.state.alarmHeard})}}]),n}(o.a.Component);function G(){var e=Object(p.a)(["\n  display: none;\n"]);return G=function(){return e},e}function Q(){var e=Object(p.a)(["\n  border-radius: 4px;\n  /*@media only screen and (max-width: 992px) {\n    display: none;\n  }*/\n"]);return Q=function(){return e},e}function K(){var e=Object(p.a)(["\n  display: inline-block;\n  margin-left: 5px;\n  margin-right: 5px;\n"]);return K=function(){return e},e}function X(){var e=Object(p.a)(["\n  display: flex;\n  width: 200px;\n  height: 25px;\n  justify-content: center;\n  align-items: center;\n"]);return X=function(){return e},e}function Y(){var e=Object(p.a)(["\n  background-color: lightsteelblue;\n  display: flex;\n  justify-content: space-evenly;\n  align-items: center;\n  margin: 5px;\n  padding: 5px;\n  border: 3px solid white;\n  width: calc(100% - 30px);\n"]);return Y=function(){return e},e}var Z=f.a.div(Y()),ee=f.a.div(X()),te=f.a.b(K()),ne=f.a.canvas(Q()),ae=f.a.audio(G()),oe=Object(B.a)({colorPrimary:"#1976d2",switchBase:{color:"#fafafa","&$checked":{color:"#1976d2"},"&$checked + $track":{backgroundColor:"#1976d2"}},checked:{},track:{}})(N.a),ie=null,re=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(e){var a;Object(l.a)(this,n),(a=t.call(this,e)).state={toggleValue:!0,solo:!1,muted:!1},a.audioCtx=a.props.audioContext,a.audioElement=null,a.spectro=null;return a.bandpassFilter=a.audioCtx.createBiquadFilter(),a.bandpassFilter.type="bandpass",a.bandpassFilter.frequency.value=1775,a.bandpassFilter.Q.value=1775/2050,a.gainNode=a.audioCtx.createGain(),a.gainNode.gain.value=1,a.analyser=a.audioCtx.createAnalyser(),a.analyser.smoothingTimeConstant=0,a.analyser.fftSize=1024,a.alarmRef=o.a.createRef(),a.onSoloClick=a.onSoloClick.bind(Object(d.a)(a)),a.onToggleChange=a.onToggleChange.bind(Object(d.a)(a)),a.toggleFilter=a.toggleFilter.bind(Object(d.a)(a)),a.cleanUp=a.cleanUp.bind(Object(d.a)(a)),a.componentDidMount=a.componentDidMount.bind(Object(d.a)(a)),a.componentWillUnmount=a.componentWillUnmount(Object(d.a)(a)),a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.audioElement=document.getElementById("audio_"+this.props.name),this.audioElement.addEventListener("volumechange",(function(){e.audioElement.muted&&e.state.solo&&e.setState({solo:!1}),e.setState({muted:e.audioElement.muted})}),!1),this.audioStream=this.audioCtx.createMediaElementSource(this.audioElement),this.spectro=F()(document.getElementById("audio_canvas_"+this.props.name),{canvas:{width:250,height:80},audio:{enable:!0},colors:function(e){for(var t=new P.a.scale([[0,0,255,1],[0,255,255,1],[0,255,0,1],[255,255,0,1],[255,0,0,1]],[0,.15,.3,.5,.75]).domain([0,e]),n=[],a=0;a<e;++a){var o=t(a);n.push(o.hex())}return n}}),this.audioStream.connect(this.bandpassFilter),this.bandpassFilter.connect(this.gainNode),this.gainNode.connect(this.analyser),this.gainNode.connect(this.audioCtx.destination),this.spectro.connectSource(this.analyser,this.audioCtx),this.spectro.start(),"suspended"===this.audioCtx.state&&this.audioCtx.resume()}},{key:"componentWillUnmount",value:function(){}},{key:"cleanUp",value:function(){return clearTimeout(ie),this.spectro.forceStop(),this.alarmRef.current.stop(),this.audioElement.removeAttribute("src"),this.audioElement.load(),this.state.solo}},{key:"onSoloClick",value:function(e){var t=this;e.preventDefault(),clearTimeout(ie),this.state.solo?(this.setState({solo:!1,muted:!1}),this.props.muteFunction(!1)):(this.props.muteFunction(!0),document.getElementById("audio_"+this.props.name).muted=!1,this.setState({solo:!0,muted:!1}),ie=setTimeout((function(){t.setState({solo:!1})}),15e3))}},{key:"onToggleChange",value:function(e){this.setState({toggleValue:e.target.checked}),this.toggleFilter(e.target.checked)}},{key:"toggleFilter",value:function(e){e?(this.audioStream.disconnect(this.gainNode),this.audioStream.connect(this.bandpassFilter),this.bandpassFilter.connect(this.gainNode)):(this.bandpassFilter.disconnect(this.gainNode),this.audioStream.disconnect(this.bandpassFilter),this.audioStream.connect(this.gainNode))}},{key:"render",value:function(){var e,t;return this.state.solo?e=o.a.createElement(H,{onClick:this.onSoloClick}):(t=this.state.muted?o.a.createElement(M.a,{fontSize:"large",style:{fill:"black"}}):o.a.createElement(D.a,{fontSize:"large",style:{fill:"black"}}),e=o.a.createElement(O.a,{type:"button",onClick:this.onSoloClick,size:"small"},o.a.createElement(T.a,{title:"Mute others",arrow:!0},t))),o.a.createElement(Z,null,e,o.a.createElement(ee,null,o.a.createElement(te,null,this.props.name+" ",o.a.createElement("span",{role:"img","aria-label":"volume-emoji"}," \ud83d\udd0a "))),o.a.createElement(ne,{id:"audio_canvas_"+this.props.name}),o.a.createElement(ae,{crossOrigin:"anonymous",className:"stream",id:"audio_"+this.props.name,autoPlay:!0,src:this.props.streamLink}),o.a.createElement(V,{ref:this.alarmRef,analyser:this.analyser,canvasHeight:80}),o.a.createElement(T.a,{title:"Noise Filter",arrow:!0},o.a.createElement(oe,{id:"checkbox_"+this.props.name,type:"checkbox",onChange:this.onToggleChange,defaultChecked:!0,value:this.state.toggleValue,color:"primary"})))}}]),n}(o.a.Component);function se(){var e=Object(p.a)(["\n  margin-top: 18px;\n"]);return se=function(){return e},e}function ce(){var e=Object(p.a)(["\n  display: inline-block;\n  background-color: aliceblue;\n  width: 46vw;\n  margin: 5px;\n  padding: 1vw;\n  @media only screen and (max-width: 992px) {\n    width: 90vw;\n    padding: 3vw;\n  }\n"]);return ce=function(){return e},e}var le=f.a.div(ce()),ue=f.a.div(se()),de=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).onRemoveClick=a.onRemoveClick.bind(Object(d.a)(a)),a.streamProxy=a.streamProxy.bind(Object(d.a)(a)),a.componentWillUnmount=a.componentWillUnmount(Object(d.a)(a)),a.streamRefs=[],a}return Object(u.a)(n,[{key:"onRemoveClick",value:function(e){e.preventDefault();for(var t=0;t<this.streamRefs.length;t++)this.streamRefs[t].cleanUp()&&this.props.muteFunction(!1);this.props.onRemoveClick(this.props.identifier)}},{key:"streamProxy",value:function(e){return e.streamLink+"_"+this.props.addCounter}},{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this;return o.a.createElement(le,null,o.a.createElement("h3",{className:"roomTitle"},this.props.identifier),this.props.streams.map((function(t,n){return o.a.createElement(re,{key:t.name,name:t.name,streamLink:t.streamLink,muteFunction:e.props.muteFunction,audioContext:e.props.audioContext,ref:function(t){e.streamRefs[n]=t}})})),o.a.createElement(ue,null,o.a.createElement(y.a,{variant:"contained",color:"primary",onClick:this.onRemoveClick,style:{background:"#1976d2"},startIcon:o.a.createElement(R.a,{fontSize:"small"})},"Remove")))}}]),n}(o.a.Component),he=n(149),me=n(162),pe=n(155),fe=n(163),ve=n(83),be=n(63),ge=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).onChange=a.onChange.bind(Object(d.a)(a)),a.handleClose=a.handleClose.bind(Object(d.a)(a)),a.state={open:!1,value:""},a}return Object(u.a)(n,[{key:"onChange",value:function(e){e.preventDefault(),this.props.changeHandler(e.target.value),this.setState({open:!0,value:e.target.value})}},{key:"handleClose",value:function(e,t){this.setState({open:!1})}},{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(be.Desktop,null,o.a.createElement(he.a,{style:{minWidth:120}},o.a.createElement(me.a,{id:"select-label"},"Rooms "),o.a.createElement(pe.a,{id:"roomSelector",labelId:"select-label",value:"",onChange:this.onChange},this.props.options.map((function(e){return o.a.createElement(fe.a,{key:e,value:e},e)}))))),o.a.createElement(be.MobileAndTablet,null,o.a.createElement(he.a,{style:{minWidth:120}},o.a.createElement(me.a,{htmlFor:"roomSelectorMobile",id:"select-label-mobile"},"Rooms "),o.a.createElement(ve.a,{id:"roomSelectorMobile",value:"default",onChange:this.onChange},o.a.createElement("option",{value:"default"},"---"),this.props.options.map((function(e){return o.a.createElement("option",{key:e,value:e},e)}))))))}}]),n}(o.a.Component),ke=n(85),Ce=n.n(ke);function ye(){var e=Object(p.a)(["\n  height: 4vh;\n  width: auto;\n  padding-right: 5px;\n"]);return ye=function(){return e},e}function xe(){var e=Object(p.a)(["\n  position: absolute;\n  bottom: 0;\n  display: flex;\n  background-color: #022169;\n  width: 100%;\n  height: 7vh;\n  justify-content: flex-end;\n  align-items: center;\n"]);return xe=function(){return e},e}function Oe(){var e=Object(p.a)(["\n  background: none;\n  border: none;\n  color: white;\n  text-decoration: underline;\n  font-size: 0.875rem;\n  font-weight: 500;\n  padding: 0;\n  cursor: pointer;\n"]);return Oe=function(){return e},e}function we(){var e=Object(p.a)(["\n  margin-top: 19px;\n  margin-bottom: 6px;\n"]);return we=function(){return e},e}function Ee(){var e=Object(p.a)(["\n  text-align: center;\n  width: 40vw;\n  margin-left: 30vw;\n"]);return Ee=function(){return e},e}function Se(){var e=Object(p.a)(["\n  margin-left: auto;\n  margin-right: 8px;\n  margin-top: 8px;\n  @media only screen and (max-width: 992px) {\n    margin-right: 4px;\n    margin-top: 4px;\n  }\n"]);return Se=function(){return e},e}function _e(){var e=Object(p.a)(["\n  display: flex;\n  margin: 0;\n  justify-content: center;\n  align-items: flex-start;\n"]);return _e=function(){return e},e}function je(){var e=Object(p.a)(["\n  margin-bottom: 18px;\n"]);return je=function(){return e},e}function Re(){var e=Object(p.a)(["\n  text-align: center;\n  padding-bottom: 9vh;\n"]);return Re=function(){return e},e}function Ae(){var e=Object(p.a)(["\n  position: relative;\n  min-height: 100vh;\n"]);return Ae=function(){return e},e}var Fe=f.a.div(Ae()),Ne=f.a.div(Re()),Te=f.a.div(je()),Ie=f.a.div(_e()),De=f.a.div(Se()),Le=f.a.div(Ee()),Me=f.a.h2(we()),Be=f.a.input(Oe()),Ue=f.a.div(xe()),Pe=f.a.img(ye());function ze(e){return o.a.createElement(S.a,Object.assign({elevation:6,variant:"filled"},e))}var We=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(e){var a;Object(l.a)(this,n),(a=t.call(this,e)).state={dropdownList:_.rooms.map((function(e){return e.identifier})),roomObjs:[],forceUpdate:!0,snackbarOpen:!1,refreshOpen:!1,snackPack:[],messageInfo:void 0,instructionOpen:!1},a.roomAddCounter=new Map,a.soloTimeout=null;for(var o=0;o<a.state.dropdownList.length;o++)a.roomAddCounter.set(a.state.dropdownList[o],1e4);var i=window.AudioContext||window.webkitAudioContext;return a.audioCtx=new i,a.incrementRoomAddCounter=a.incrementRoomAddCounter.bind(Object(d.a)(a)),a.onRoomAdd=a.onRoomAdd.bind(Object(d.a)(a)),a.onRoomRemove=a.onRoomRemove.bind(Object(d.a)(a)),a.muteTemp=a.muteTemp.bind(Object(d.a)(a)),a.componentDidMount=a.componentDidMount.bind(Object(d.a)(a)),a.componentDidUpdate=a.componentDidUpdate.bind(Object(d.a)(a)),a.handleSnackbarExited=a.handleSnackbarExited.bind(Object(d.a)(a)),a.handleSnackbarClose=a.handleSnackbarClose.bind(Object(d.a)(a)),a.handleRefreshSnackbarClose=a.handleRefreshSnackbarClose.bind(Object(d.a)(a)),a.onRefreshClick=a.onRefreshClick.bind(Object(d.a)(a)),a.onInstructionClick=a.onInstructionClick.bind(Object(d.a)(a)),a.handleInstructionClose=a.handleInstructionClose.bind(Object(d.a)(a)),a}return Object(u.a)(n,[{key:"incrementRoomAddCounter",value:function(e){this.roomAddCounter.set(e,this.roomAddCounter.get(e)+1)}},{key:"onRoomAdd",value:function(e){this.incrementRoomAddCounter(e);var t=e+" added!";this.state.roomObjs.push(_.rooms[_.rooms.map((function(e){return e.identifier})).indexOf(e)]),this.state.dropdownList.splice(this.state.dropdownList.indexOf(e),1),this.state.snackPack.push({message:t,key:(new Date).getTime()}),this.setState({forceUpdate:!this.state.forceUpdate})}},{key:"onRoomRemove",value:function(e){var t=e+" removed!";this.state.dropdownList.push(e),this.state.roomObjs.splice(this.state.roomObjs.findIndex((function(t){return t.identifier===e})),1),this.state.snackPack.push({message:t,key:(new Date).getTime()}),this.setState({forceUpdate:!this.state.forceUpdate})}},{key:"muteTemp",value:function(e){var t,n=Object(c.a)(document.getElementsByClassName("stream"));try{for(n.s();!(t=n.n()).done;){t.value.muted=e}}catch(a){n.e(a)}finally{n.f()}clearTimeout(this.soloTimeout),e&&(this.soloTimeout=setTimeout((function(){var e,t=Object(c.a)(document.getElementsByClassName("stream"));try{for(t.s();!(e=t.n()).done;){e.value.muted=!1}}catch(a){t.e(a)}finally{t.f()}}),15e3))}},{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){setInterval((function(){e.setState({refreshOpen:!0})}),36e5),e.setState({refreshOpen:!0})}),36e5)}},{key:"componentDidUpdate",value:function(){this.state.snackPack.length&&!this.state.messageInfo?this.setState({messageInfo:Object(s.a)({},this.state.snackPack[0]),snackPack:this.state.snackPack.slice(1),snackbarOpen:!0}):this.state.snackPack.length&&this.state.messageInfo&&this.state.snackbarsnackbarOpen&&this.setState({snackbarOpen:!1})}},{key:"handleSnackbarExited",value:function(){this.setState({messageInfo:void 0})}},{key:"handleSnackbarClose",value:function(e,t){this.setState({snackbarOpen:!1})}},{key:"handleRefreshSnackbarClose",value:function(e,t){"clickaway"!==t&&this.setState({refreshOpen:!1})}},{key:"onRefreshClick",value:function(e){e.preventDefault(),window.location.reload()}},{key:"onInstructionClick",value:function(e){e.preventDefault(),this.setState({instructionOpen:!0})}},{key:"handleInstructionClose",value:function(){this.setState({instructionOpen:!1})}},{key:"render",value:function(){var e=this,t=o.a.createElement(v.a,{onClose:this.handleInstructionClose,open:this.state.instructionOpen,"aria-labelledby":"instruction-dialog-title"},o.a.createElement(b.a,{id:"instruction-dialog-title"},"Instructions"),o.a.createElement(g.a,null,o.a.createElement(k.a,{id:"alert-dialog-description"},"Use the select menu to add rooms. Clicking the volume indicator will mute all other streams for 15 seconds. Clicking it again during the 15 second period will unmute all streams. The toggle turns the background noise filter on and off.",o.a.createElement("br",null),o.a.createElement("br",null),"We recommend using Firefox.")),o.a.createElement(C.a,null,o.a.createElement(y.a,{autoFocus:!0,onClick:this.handleInstructionClose,color:"primary",style:{color:"#1976d2"}},"Close"))),n=o.a.createElement(x.a,{key:this.state.messageInfo?this.state.messageInfo.key:void 0,anchorOrigin:{vertical:"bottom",horizontal:"left"},open:this.state.snackbarOpen,autoHideDuration:3e3,onClose:this.handleSnackbarClose,onExited:this.handleSnackbarExited},o.a.createElement(ze,{onClose:this.handleSnackbarClose,severity:"success"},this.state.messageInfo?this.state.messageInfo.message:void 0)),a=o.a.createElement(x.a,{key:"refreshSnackbar",anchorOrigin:{vertical:"bottom",horizontal:"right"},open:this.state.refreshOpen,onClose:this.handleRefreshSnackbarClose},o.a.createElement(ze,{onClose:this.handleRefreshSnackbarClose,severity:"warning"},"Please ",o.a.createElement(Be,{type:"button",value:"refresh",onClick:this.onRefreshClick})," for improved performance."));return o.a.createElement(Fe,null,o.a.createElement(Ie,null,o.a.createElement(Le,null,o.a.createElement(Me,null,"Alarm Monitoring System")),o.a.createElement(De,null,o.a.createElement(O.a,{"aria-label":"info",onClick:this.onInstructionClick,style:{color:"#1976d2"},size:"small"},o.a.createElement(E.a,{style:{fontSize:"30px"}}))),t),o.a.createElement(Ne,null,o.a.createElement(Te,null,o.a.createElement(ge,{options:this.state.dropdownList,changeHandler:this.onRoomAdd})),this.state.roomObjs.map((function(t){return o.a.createElement(de,{key:t.identifier,identifier:t.identifier,streams:t.streams,addCounter:e.roomAddCounter.get(t.identifier),onRemoveClick:e.onRoomRemove,muteFunction:e.muteTemp,audioContext:e.audioCtx})})),n,a),o.a.createElement(Ue,null,o.a.createElement(Pe,{src:Ce.a,alt:"Columbia Logo"})))}}]),n}(o.a.Component);r.a.render(o.a.createElement(We,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},59:function(e){e.exports=JSON.parse('{"rooms":[{"identifier":"room123","streams":[{"name":"RaspberryPi","streamLink":"http://192.168.2.65:8000/livemic"},{"name":"Alarm1","streamLink":"https://alarmtest.ceec.echem.io/alarm"},{"name":"Livemic1","streamLink":"https://alarmtest.ceec.echem.io/livemic"}]},{"identifier":"room124","streams":[{"name":"Alarm","streamLink":"https://alarmtest.ceec.echem.io/alarm"},{"name":"Livemic","streamLink":"https://alarmtest.ceec.echem.io/livemic"},{"name":"Test_1","streamLink":"https://alarmtest.ceec.echem.io/test_1"}]},{"identifier":"room125","streams":[{"name":"Alarm2","streamLink":"https://alarmtest.ceec.echem.io/alarm"},{"name":"Livemic2","streamLink":"https://alarmtest.ceec.echem.io/livemic"},{"name":"Test12","streamLink":"https://alarmtest.ceec.echem.io/test_1"}]},{"identifier":"room126","streams":[{"name":"Alarm3","streamLink":"https://alarmtest.ceec.echem.io/alarm"},{"name":"Livemic3","streamLink":"https://alarmtest.ceec.echem.io/livemic"},{"name":"Test13","streamLink":"https://alarmtest.ceec.echem.io/test_1"}]}]}')},71:function(e,t,n){!function(n){function a(e){return function(e){return"function"===typeof e}(e)?e():e}var o=Object.prototype.toString;function i(e,t){if(!(this instanceof i))return new i(e,t);var n=t.canvas||{};this._audioEnded=null,this._paused=null,this._pausedAt=null,this._startedAt=null,this._sources={audioBufferStream:null,userMediaStream:null},this._forceStop=!1,this._baseCanvas=e,this._baseCanvasContext=this._baseCanvas.getContext("2d"),this._baseCanvas.width=a(n.width)||this._baseCanvas.width,this._baseCanvas.height=a(n.height)||this._baseCanvas.height,window.onresize=function(){this._baseCanvas.width=a(n.width)||this._baseCanvas.width,this._baseCanvas.height=a(n.height)||this._baseCanvas.height}.bind(this);var o=t.audio||{};this.audio=o;var r=[];r="function"===typeof t.colors?t.colors(275):this._generateDefaultColors(275),this._colors=r,this._baseCanvasContext.fillStyle=this._getColor(0),this._baseCanvasContext.fillRect(0,0,this._baseCanvas.width,this._baseCanvas.height)}i.prototype._init=function(){var e=this._sources.audioBufferStream;e.scriptNode=e.audioContext.createScriptProcessor(2048,1,1),e.scriptNode.connect(e.audioContext.destination),e.scriptNode.onaudioprocess=function(t){var n=new Uint8Array(e.analyser.frequencyBinCount);e.analyser.getByteFrequencyData(n),this._draw(n,e.canvasContext)}.bind(this),e.sourceNode.onended=function(){this.stop()}.bind(this),e.analyser=e.audioContext.createAnalyser(),e.analyser.smoothingTimeConstant=0,e.analyser.fftSize=1024,e.analyser.connect(e.scriptNode),e.sourceNode.connect(e.analyser),this.audio.enable&&e.scriptNode.connect(e.audioContext.destination)},i.prototype._draw=function(e,t){if(this._paused)return!1;var n=t.canvas,a=n.width,o=n.height,i=t._tempContext,r=i.canvas;i.drawImage(n,0,0,a,o);for(var s=0;s<Math.min(e.length-4);s++){var c=e[s+4];t.fillStyle=this._getColor(c),this._audioEnded&&(t.fillStyle=this._getColor(0)),t.fillRect(a-1,o-s,1,1)}t.translate(-1,0),t.drawImage(r,0,0,a,o,0,0,a,o),t.setTransform(1,0,0,1,0,0),this._baseCanvasContext.drawImage(n,0,0,a,o)},i.prototype._startMediaStreamDraw=function(e,t){if(!this._forceStop){window.requestAnimationFrame(this._startMediaStreamDraw.bind(this,e,t));var n=Math.min(t.canvas.height+5+4,e.frequencyBinCount),a=new Uint8Array(n);e.getByteFrequencyData(a),this._draw(a,t)}},i.prototype.connectSource=function(e,t){var n=this._sources.audioBufferStream||{};if("[object ScriptProcessorNode]"===o.call(n.scriptNode)&&(n.scriptNode.onaudioprocess=null),"[object AudioBuffer]"===o.call(e)){var a=(t=!t&&n.audioBuffer.context||!t&&n.audioContext||t).createBufferSource();a.buffer=e;var i=n.canvasContext;if(!n.canvasContext){var r=document.createElement("canvas");r.width=this._baseCanvas.width,r.height=this._baseCanvas.height,i=r.getContext("2d");var s=document.createElement("canvas");s.width=r.width,s.height=r.height,i._tempContext=s.getContext("2d")}n={audioBuffer:e,audioContext:t,sourceNode:a,analyser:null,scriptNode:null,canvasContext:i},this._sources.audioBufferStream=n,this._init()}"[object AnalyserNode]"===o.call(e)&&((n=this._sources.userMediaStream||{}).analyser=e,this._sources.userMediaStream=n)},i.prototype.start=function(e){var t=this._sources.audioBufferStream,n=this._sources.userMediaStream;if(t&&t.sourceNode&&(t.sourceNode.start(0,e||0),this._audioEnded=!1,this._paused=!1,this._startedAt=Date.now()),n&&n.analyser){t=n;var a=document.createElement("canvas");a.width=this._baseCanvas.width,a.height=this._baseCanvas.height;var o=a.getContext("2d"),i=document.createElement("canvas");i.width=a.width,i.height=a.height,o._tempContext=i.getContext("2d"),this._startMediaStreamDraw(t.analyser,o)}},i.prototype.forceStop=function(){this._forceStop=!0},i.prototype.stop=function(){var e=this._sources[Object.keys(this._sources)[0]];e&&e.sourceNode&&e.sourceNode.stop(),this._audioEnded=!0},i.prototype.pause=function(){this.stop(),this._paused=!0,this._pausedAt+=Date.now()-this._startedAt},i.prototype.resume=function(e){var t=this._sources[Object.keys(this._sources)[0]];this._paused=!1,this._pausedAt&&(this.connectSource(t.audioBuffer,t.audioContext),this.start(e||this._pausedAt/1e3))},i.prototype.clear=function(e){var t=this._sources[Object.keys(this._sources)[0]];this.stop(),"[object ScriptProcessorNode]"===o.call(t.scriptNode)&&(t.scriptNode.onaudioprocess=null);var n=(e=e||t.canvasContext).canvas;e.clearRect(0,0,n.width,n.height),e._tempContext.clearRect(0,0,n.width,n.height),this._baseCanvasContext.clearRect(0,0,n.width,n.height)},i.prototype._generateDefaultColors=function(e){var t=Math.PI/e,n=Math.PI/2*3.1,a=[];function o(e){return"rgba("+[e,e,e,1].toString()+")"}for(var i=0;i<e;i++){var r=127*Math.sin(t*i+n)+128>>0;a.push(o(r))}return a},i.prototype._getColor=function(e){var t=this._colors[e];return"undefined"===typeof t&&(t=this._colors[0]),t},e.exports&&(t=e.exports=i),t.Spectrogram=i}()},85:function(e,t,n){e.exports=n.p+"static/media/Columbia_University_Logo-white.0f48c6df.png"},99:function(e,t,n){e.exports=n(112)}},[[99,1,2]]]);